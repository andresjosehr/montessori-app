"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[257],{5257:(Ge,N,s)=>{s.r(N),s.d(N,{StudentsModule:()=>we});var g=s(6895),_=s(2510),u=s(7155),P=s(7579),w=s(2722),t=s(4650),v=s(529),c=s(2340);let C=(()=>{class n{constructor(e){this._httpClient=e}getList(e,o){const i=new v.LE({fromObject:{...o,...e}});return this._httpClient.get(`${c.N.api}/students`,{params:i})}getAll(e){const o=new v.LE({fromObject:{...e}});return this._httpClient.get(`${c.N.api}/students/get-all`,{params:o})}get(e){return this._httpClient.get(`${c.N.api}/students/${e}`)}uploadFile(e){const o=new FormData;o.append("file",e,e.name);const i=new v.WM;return i.append("Content-Type","multipart/form-data"),i.append("Accept","application/json"),this._httpClient.post(`${c.N.api}/students/upload-file`,o,{headers:i})}create(e){const o=new FormData;for(const r in e)e.hasOwnProperty(r)&&"img"!==r&&"broker_logo"!==r&&o.append(r,e[r]);const i=new v.WM;return i.append("Content-Type","multipart/form-data"),i.append("Accept","application/json"),this._httpClient.post(`${c.N.api}/students`,o,{headers:i})}update(e,o){const i=new FormData;for(const m in o)o.hasOwnProperty(m)&&"img"!==m&&"broker_logo"!==m&&i.append(m,o[m]);const r=new v.WM;return r.append("Content-Type","multipart/form-data"),r.append("Accept","application/json"),r.append("_method","PUT"),this._httpClient.post(`${c.N.api}/students/${e}?_method=PUT`,i,{headers:r})}getPropertyEntities(){return this._httpClient.get(`${c.N.api}/students/get-property-entities`)}completeSignUp(e,o){return this._httpClient.post(`${c.N.api}/students/complete-signup/${o}`,e)}resendSignUpEmail(e){return this._httpClient.get(`${c.N.api}/students/resend-signup-email/${e}`,{})}getAllLevels(){return this._httpClient.get(`${c.N.api}/get-all-levels`)}registerPayment(e,o){return this._httpClient.post(`${c.N.api}/students/register-payment/${e}`,o)}registerEnrollmentPayment(e,o){return this._httpClient.post(`${c.N.api}/students/register-enrollment-payment/${e}`,o)}getEnrollmentPayments(e){return this._httpClient.get(`${c.N.api}/students/get-enrollment-payment/${e}`)}getPayments(e,o){return this._httpClient.get(`${c.N.api}/students/payment-control/${e}/${o}`)}delete(e){return this._httpClient.delete(`${c.N.api}/students/${e}`)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(v.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var l=s(4006),x=s(4031),J=s(1683),y=s(4859),d=s(9549),f=s(4144),G=s(2494),b=s(8739),T=s(7392);function V(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"creado"),t.qZA())}function k(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"actualizado"),t.qZA())}function B(n,a){if(1&n&&(t.TgZ(0,"fuse-alert",33)(1,"span",34),t._uU(2,"Exito"),t.qZA(),t._uU(3," El alumno ha sido "),t.YNc(4,V,2,0,"span",35),t.YNc(5,k,2,0,"span",35),t._uU(6," exitosamente "),t.qZA()),2&n){const e=t.oxw();t.Q6J("type","success"),t.xp6(4),t.Q6J("ngIf","1"===e.m),t.xp6(1),t.Q6J("ngIf","2"===e.m)}}function L(n,a){1&n&&(t.TgZ(0,"th",36),t._uU(1,"ID"),t.qZA())}function O(n,a){if(1&n&&(t.TgZ(0,"td",37)(1,"span",38),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.id," ")}}function $(n,a){1&n&&(t.TgZ(0,"th",36),t._uU(1,"Nombres"),t.qZA())}function j(n,a){if(1&n&&(t.TgZ(0,"td",37)(1,"span",38),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.name," ")}}function R(n,a){1&n&&(t.TgZ(0,"th",36),t._uU(1,"Apellidos"),t.qZA())}function z(n,a){if(1&n&&(t.TgZ(0,"td",37)(1,"span",38),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.last_name," ")}}function H(n,a){1&n&&(t.TgZ(0,"th",36),t._uU(1,"Representante"),t.qZA())}function X(n,a){if(1&n&&(t.TgZ(0,"td",37)(1,"span",38),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.representative_name||"-"," ")}}function K(n,a){1&n&&(t.TgZ(0,"th",36),t._uU(1,"Numero representante"),t.qZA())}function W(n,a){if(1&n&&(t.TgZ(0,"td",37)(1,"span",38),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.representative_phone||"-"," ")}}function tt(n,a){1&n&&(t.TgZ(0,"th",36),t._uU(1,"Grado"),t.qZA())}function et(n,a){if(1&n&&(t.TgZ(0,"td",37)(1,"span",38),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.level.name||"-"," ")}}function nt(n,a){1&n&&(t.TgZ(0,"th",36),t._uU(1,"Acciones"),t.qZA())}function ot(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",37)(1,"div",39)(2,"div",40)(3,"button",41),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.goToStudent(r.id))}),t.TgZ(4,"mat-icon"),t._uU(5,"edit"),t.qZA()()(),t.TgZ(6,"div",40)(7,"button",42),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.goToPaymentControl(r.id))}),t.TgZ(8,"mat-icon"),t._uU(9," attach_money"),t.qZA()()(),t.TgZ(10,"div",40)(11,"button",43),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.deleteStudent(r.id))}),t.TgZ(12,"mat-icon"),t._uU(13," delete"),t.qZA()()()()()}}function at(n,a){1&n&&t._UZ(0,"tr",44)}function it(n,a){1&n&&t._UZ(0,"tr",45)}const rt=function(){return[10,25,100]};let lt=(()=>{class n{constructor(e,o,i,r,m,p){this._studentsService=e,this._activatedRoute=o,this._router=i,this._formBuilder=r,this._globalService=m,this._fuseConfirmationService=p,this.columns=["id","name","last_name","representative_name","representative_phone","Grado","acciones"],this.m=null,this._unsubscribeAll=new P.x}paginate(e){this.getStudents(this.getValues(),{page:e.pageIndex+1,perPage:e.pageSize})}ngOnInit(){this.seachFormGroup=this._formBuilder.group({file:[null],city:[null],company:[null],profession:[null],fileSelect:["Seleccionar"],citySelect:["Seleccionar"],companySelect:["Seleccionar"],professionSelect:["Seleccionar"]}),this._activatedRoute.params.pipe((0,w.R)(this._unsubscribeAll)).subscribe(e=>{e.m&&(this.m=e.m)}),this.getStudents({})}getStudents(e,o={page:1,perPage:10}){this._studentsService.getList(e,o).subscribe(i=>{this.dataSource=new u.by(i.data.data),this.studentsPaginated=i.data})}filter(e,o){const i=e.toLowerCase();return o.filter(r=>(r||"").toLowerCase().includes(i))}fileChange(e){this.file=e}goToStudent(e){this._router.navigate(["alumnos","editar",e])}goToPaymentControl(e){this._router.navigate(["alumnos","control-de-pago",e])}uploadFile(){this._studentsService.uploadFile(this.file).subscribe(e=>{console.log(e)})}filterStudents(){console.log(this.getValues()),this.getStudents(this.getValues())}getValues(){const e={};return this.seachFormGroup.value.fileSelect&&"Seleccionar"!==this.seachFormGroup.value.fileSelect&&(e.file=this.seachFormGroup.value.fileSelect),this.seachFormGroup.value.citySelect&&"Seleccionar"!==this.seachFormGroup.value.citySelect&&(e.city=this.seachFormGroup.value.citySelect),this.seachFormGroup.value.companySelect&&"Seleccionar"!==this.seachFormGroup.value.companySelect&&(e.company=this.seachFormGroup.value.companySelect),this.seachFormGroup.value.professionSelect&&"Seleccionar"!==this.seachFormGroup.value.professionSelect&&(e.profession=this.seachFormGroup.value.professionSelect),e}export(){this._studentsService.getAll(this.getValues()).subscribe(e=>{this._globalService.saveDataAsCSV(e.data,"studentos")})}resendSignUpEmail(e){this._studentsService.resendSignUpEmail(e).subscribe(o=>{this._globalService.openSnackBar("Correo enviado",5e3,"success"),console.log(o)})}deleteStudent(e){this._fuseConfirmationService.open({title:"Atenci\xf3n",message:"\xbfEst\xe1 seguro que desea eliminar este alumno? La informaci\xf3n de pagos tambi\xe9n se eliminar\xe1. Esta acci\xf3n no se puede deshacer.",icon:{show:!0,name:"heroicons_outline:exclamation",color:"warning"},actions:{confirm:{show:!0,label:"Confirmar",color:"accent"},cancel:{show:!0,label:"Cancelar"}},dismissible:!0}).afterClosed().subscribe(i=>{"confirmed"===i&&this._studentsService.delete(e).subscribe(r=>{this._globalService.openSnackBar("Alumno eliminado",5e3,"success"),this.dataSource.data=this.dataSource.data.filter(m=>m.id!==e)})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(C),t.Y36(_.gz),t.Y36(_.F0),t.Y36(l.qu),t.Y36(x.U),t.Y36(J.R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-students-list"]],decls:55,vars:10,consts:[[1,"w-full"],[1,"grid","sm:grid-cols-2","gap-8","w-full","mb-6"],[1,"w-full","col-span-1"],[1,"text-3xl","font-bold"],[1,"text-secondary"],[1,"text-right"],["mat-stroked-button","",1,"rounded","mr-1","px-3","bg-primary-300","text-on-primary-300",3,"routerLink"],[3,"type",4,"ngIf"],[1,"sm:col-span-6","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"grid","grid-cols-12"],[1,"col-span-3"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[1,"col-span-9"],[1,"flex","gap-3","justify-end",3,"formGroup"],[1,"w-2/5"],["type","text","matInput",""],[1,"w-1/5"],[1,"flex","mt-7","gap-1"],["mat-stroked-button","",1,"rounded","w-full","p-0","bg-primary-300","text-on-primary-300",3,"click"],[1,"flex","flex-col","flex-auto","mt-2","overflow-x-auto"],["mat-table","",1,"min-w-240","overflow-y-visible",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","last_name"],["matColumnDef","representative_name"],["matColumnDef","representative_phone"],["matColumnDef","Grado"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["class","cursor-pointer","mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",3,"length","pageSize","pageSizeOptions","page"],[3,"type"],["fuseAlertTitle",""],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],[1,"font-medium"],[1,"flex","gap-2"],[1,"1/2"],["mat-mini-fab","",1,"rounded","bg-primary-300","text-on-primary-300",3,"click"],["mat-mini-fab","",1,"rounded","bg-green-300","text-green-800",3,"click"],["mat-mini-fab","",1,"rounded","bg-red-300","text-red-800",3,"click"],["mat-header-row",""],["mat-row","",1,"cursor-pointer"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Alumnos"),t.qZA(),t.TgZ(5,"div",4),t._uU(6,"Una lista de alumnos registradas en el sistema"),t.qZA()(),t.TgZ(7,"div",2)(8,"div",5)(9,"button",6),t._uU(10,"Crear Alumno"),t.qZA()()(),t.TgZ(11,"div",2),t.YNc(12,B,7,3,"fuse-alert",7),t.qZA()(),t.TgZ(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11),t._uU(17,"Detalles de alumno"),t.qZA()(),t.TgZ(18,"div",12)(19,"div",13)(20,"div",14)(21,"mat-form-field",0)(22,"mat-label"),t._uU(23,"Buscar Alumno"),t.qZA(),t._UZ(24,"input",15),t.qZA()(),t.TgZ(25,"div",16)(26,"div",17)(27,"button",18),t.NdJ("click",function(){return o.filterStudents()}),t._uU(28,"Buscar"),t.qZA()()()()()(),t.TgZ(29,"div",19)(30,"table",20),t.ynx(31,21),t.YNc(32,L,2,0,"th",22),t.YNc(33,O,3,1,"td",23),t.BQk(),t.ynx(34,24),t.YNc(35,$,2,0,"th",22),t.YNc(36,j,3,1,"td",23),t.BQk(),t.ynx(37,25),t.YNc(38,R,2,0,"th",22),t.YNc(39,z,3,1,"td",23),t.BQk(),t.ynx(40,26),t.YNc(41,H,2,0,"th",22),t.YNc(42,X,3,1,"td",23),t.BQk(),t.ynx(43,27),t.YNc(44,K,2,0,"th",22),t.YNc(45,W,3,1,"td",23),t.BQk(),t.ynx(46,28),t.YNc(47,tt,2,0,"th",22),t.YNc(48,et,3,1,"td",23),t.BQk(),t.ynx(49,29),t.YNc(50,nt,2,0,"th",22),t.YNc(51,ot,14,0,"td",23),t.BQk(),t.YNc(52,at,1,0,"tr",30),t.YNc(53,it,1,0,"tr",31),t.qZA(),t.TgZ(54,"mat-paginator",32),t.NdJ("page",function(r){return o.paginate(r)}),t.qZA()()()()),2&e&&(t.xp6(9),t.Q6J("routerLink","/alumnos/crear"),t.xp6(3),t.Q6J("ngIf",o.m),t.xp6(7),t.Q6J("formGroup",o.seachFormGroup),t.xp6(11),t.Q6J("dataSource",o.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",o.columns),t.xp6(1),t.Q6J("matRowDefColumns",o.columns),t.xp6(1),t.Q6J("length",null==o.studentsPaginated?null:o.studentsPaginated.total)("pageSize",null==o.studentsPaginated?null:o.studentsPaginated.per_page)("pageSizeOptions",t.DdM(9,rt)))},dependencies:[g.O5,y.lW,d.KE,d.hX,l.JL,l.sg,_.rH,f.Nt,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,G.W,b.NW,T.Hw]}),n})();var mt=s(6466),Z=s(4385),A=s(3238);function st(n,a){if(1&n&&(t.TgZ(0,"fuse-alert",24),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.Q6J("appearance","outline")("showIcon",!1)("type",e.alert.type)("@shake","error"===e.alert.type),t.xp6(1),t.hij(" ",e.alert.message," ")}}function ut(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Este campo es obligatorio"),t.qZA())}function pt(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Este campo es obligatorio"),t.qZA())}function ct(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.hij(" ",o.studentForm.get("name").errors[e]," ")}}function dt(n,a){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,ct,2,1,"ng-container",13),t.qZA()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.studentForm.get("code").hasError(e))}}function _t(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Este campo es obligatorio"),t.qZA())}function gt(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Este campo es obligatorio"),t.qZA())}function ft(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.hij(" ",o.studentForm.get("last_name").errors[e]," ")}}function ht(n,a){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,ft,2,1,"ng-container",13),t.qZA()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.studentForm.get("code").hasError(e))}}function vt(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.hij(" ",o.studentForm.get("representative_name").errors[e]," ")}}function yt(n,a){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,vt,2,1,"ng-container",13),t.qZA()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.studentForm.get("representative_name").hasError(e))}}function Zt(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.hij(" ",o.studentForm.get("representative_phone").errors[e]," ")}}function Ct(n,a){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,Zt,2,1,"ng-container",13),t.qZA()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.studentForm.get("representative_phone").hasError(e))}}function xt(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.hij(" ",o.studentForm.get("document").errors[e]," ")}}function Tt(n,a){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,xt,2,1,"ng-container",13),t.qZA()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.studentForm.get("document").hasError(e))}}function bt(n,a){if(1&n&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function At(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.hij(" ",o.studentForm.get("level_id").errors[e]," ")}}function St(n,a){if(1&n&&(t.TgZ(0,"mat-error"),t.YNc(1,At,2,1,"ng-container",13),t.qZA()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.studentForm.get("level_id").hasError(e))}}let Y=(()=>{class n{constructor(e,o,i,r,m,p){this._globalService=e,this._activateRoute=o,this._formBuilder=i,this._router=r,this._studentsService=m,this._entityPropertiesService=p,this.alert={type:"success",message:""},this.showAlert=!1,this.studentID=""}ngOnInit(){this.initForm(),this._activateRoute.params.subscribe(e=>{e.id&&(this.studentID=e.id,this.getStudent())}),this.getLevels()}initForm(){this.studentForm=this._formBuilder.group({name:[""],last_name:[""],representative_name:[""],representative_phone:[""],level_id:[""],document:[""]})}getLevels(){this._studentsService.getAllLevels().subscribe(e=>{this.levels=e.data})}getStudent(){this._studentsService.get(this.studentID).subscribe(e=>{this.studentForm.patchValue(e.data)})}createStudent(){this.studentForm.invalid?this.studentForm.markAllAsTouched():(this.studentForm.disable(),this.studentForm.updateValueAndValidity(),this.showAlert=!1,this._studentsService.create(this.studentForm.value).pipe().subscribe(()=>{this.studentForm.enable(),this._router.navigate(["/alumnos/lista",{m:1}])},e=>{this.studentForm.enable(),e.message===this._globalService.httpValidationErrorMessage&&(this.studentForm=this._globalService.getValidationErrors(this.studentForm,e),this.alert={type:"error",message:`${e.message}`},this.showAlert=!0)}))}updateStudent(){this.studentForm.markAllAsTouched(),!this.studentForm.invalid&&(this.studentForm.disable(),this.showAlert=!1,this._studentsService.update(this.studentID,this.studentForm.value).pipe().subscribe(()=>{this.studentForm.enable(),this._router.navigate(["/alumnos/lista",{m:2}])},e=>{this.studentForm.enable(),e.message===this._globalService.httpValidationErrorMessage&&(this.studentForm=this._globalService.getValidationErrors(this.studentForm,e),this.alert={type:"error",message:`${e.message}`},this.showAlert=!0)}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.U),t.Y36(_.gz),t.Y36(l.qu),t.Y36(_.F0),t.Y36(C),t.Y36(mt.R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-manage-student"]],decls:58,vars:15,consts:[[1,"w-full","max-w-3xl","m-auto"],[1,"grid","sm:grid-cols-2","gap-8","w-full","mb-8"],[1,"w-full","col-span-1"],[1,"text-3xl","font-bold"],[1,"text-secondary"],[1,"w-full","col-span-1",3,"formGroup"],[1,"col-span-1","relative"],[1,"absolute","-translate-y-2/4","top-2/4","left-0","right-0"],[3,"appearance","showIcon","type",4,"ngIf"],[1,"grid","sm:grid-cols-2","gap-y-1","gap-x-5","w-full","mt-8",3,"formGroup"],[1,"col-span-1"],[1,"w-full"],["id","name","type","text","formControlName","name","matInput",""],[4,"ngIf"],[4,"ngFor","ngForOf"],["id","last_name","type","text","formControlName","last_name","matInput",""],["id","representative_name","type","text","formControlName","representative_name","matInput",""],["id","representative_phone","type","text","formControlName","representative_phone","matInput",""],["id","document","type","text","formControlName","document","matInput",""],["formControlName","level_id"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-11","mb-10","border-t"],[1,"flex","items-center","justify-end"],["mat-flat-button","","type","button",1,"ml-4",3,"color","click"],[3,"appearance","showIcon","type"],[3,"value"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"form")(2,"div",1)(3,"div",2)(4,"div",3),t._uU(5,"Crear Alumno"),t.qZA(),t.TgZ(6,"div",4),t._uU(7,"Ingresa la informacion para crear un alumno"),t.qZA()(),t._UZ(8,"div",5),t.TgZ(9,"div",6)(10,"div",7),t.YNc(11,st,2,5,"fuse-alert",8),t.qZA()()(),t.TgZ(12,"div",9)(13,"div",10)(14,"mat-form-field",11)(15,"mat-label"),t._uU(16,"Nombres"),t.qZA(),t._UZ(17,"input",12),t.YNc(18,ut,2,0,"mat-error",13),t.YNc(19,pt,2,0,"mat-error",13),t.YNc(20,dt,2,1,"mat-error",14),t.qZA()(),t.TgZ(21,"div",10)(22,"mat-form-field",11)(23,"mat-label"),t._uU(24,"Apellidos"),t.qZA(),t._UZ(25,"input",15),t.YNc(26,_t,2,0,"mat-error",13),t.YNc(27,gt,2,0,"mat-error",13),t.YNc(28,ht,2,1,"mat-error",14),t.qZA()(),t.TgZ(29,"div",10)(30,"mat-form-field",11)(31,"mat-label"),t._uU(32,"Representante"),t.qZA(),t._UZ(33,"input",16),t.YNc(34,yt,2,1,"mat-error",14),t.qZA()(),t.TgZ(35,"div",10)(36,"mat-form-field",11)(37,"mat-label"),t._uU(38,"Telefono representante"),t.qZA(),t._UZ(39,"input",17),t.YNc(40,Ct,2,1,"mat-error",14),t.qZA()(),t.TgZ(41,"div",10)(42,"mat-form-field",11)(43,"mat-label"),t._uU(44,"Cedula estudiantil"),t.qZA(),t._UZ(45,"input",18),t.YNc(46,Tt,2,1,"mat-error",14),t.qZA()(),t.TgZ(47,"div",10)(48,"mat-form-field",11)(49,"mat-label"),t._uU(50,"Grado"),t.qZA(),t.TgZ(51,"mat-select",19),t.YNc(52,bt,2,2,"mat-option",20),t.qZA(),t.YNc(53,St,2,1,"mat-error",14),t.qZA()()(),t._UZ(54,"div",21),t.TgZ(55,"div",22)(56,"button",23),t.NdJ("click",function(){return o.studentID?o.updateStudent():o.createStudent()}),t._uU(57,"Guardar "),t.qZA()()()()),2&e&&(t.xp6(8),t.Q6J("formGroup",o.studentForm),t.xp6(3),t.Q6J("ngIf",o.showAlert),t.xp6(1),t.Q6J("formGroup",o.studentForm),t.xp6(6),t.Q6J("ngIf",o.studentForm.get("name").hasError("required")),t.xp6(1),t.Q6J("ngIf",o.studentForm.get("name").hasError("name")),t.xp6(1),t.Q6J("ngForOf",o._globalService.errorsLength(o.studentForm.get("name"))),t.xp6(6),t.Q6J("ngIf",o.studentForm.get("last_name").hasError("required")),t.xp6(1),t.Q6J("ngIf",o.studentForm.get("last_name").hasError("last_name")),t.xp6(1),t.Q6J("ngForOf",o._globalService.errorsLength(o.studentForm.get("last_name"))),t.xp6(6),t.Q6J("ngForOf",o._globalService.errorsLength(o.studentForm.get("representative_name"))),t.xp6(6),t.Q6J("ngForOf",o._globalService.errorsLength(o.studentForm.get("representative_phone"))),t.xp6(6),t.Q6J("ngForOf",o._globalService.errorsLength(o.studentForm.get("document"))),t.xp6(6),t.Q6J("ngForOf",o.levels),t.xp6(1),t.Q6J("ngForOf",o._globalService.errorsLength(o.studentForm.get("level_id"))),t.xp6(3),t.Q6J("color","primary"))},dependencies:[g.sg,g.O5,d.TO,d.KE,d.hX,f.Nt,Z.gD,A.ey,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,l.F,y.lW]}),n})();var h=s(7340),D=s(269);let Ft=(()=>{class n{constructor(e,o,i,r,m){this._formBuilder=e,this._studentsService=o,this._globalService=i,this._activatedRoute=r,this._paymentControlService=m,this.documentTypeEnrollmentFG=new l.NI,this.enrollmentFG=this._formBuilder.group({full_name:[],document:[],month:[],year:[],ves_amount:[],usd_amount:[],payment_date:[],payment_method:[],reference_number:[],payer_type:[]}),this._paymentControlService.getEnrollmentFees().subscribe(p=>{this.enrollmentFee=p.data[0].amount_usd,this.getBCV()}),this._activatedRoute.params.subscribe(p=>{p.id&&(this.estudianteID=p.id,this.getEnrollmentPaymentData())}),this.enrollmentFG.get("payer_type").valueChanges.subscribe(p=>{this.documentTypeEnrollmentFG.setValue("Natural"===p?"V":"J")})}getBCV(){this._paymentControlService.getDolarBCV().subscribe(e=>{this.dolarBCV=e.data,this.enrollmentFG.get("usd_amount").setValue(this.enrollmentFee,{emitEvent:!1}),this.enrollmentFG.get("ves_amount").setValue(this.enrollmentFee*this.dolarBCV,{emitEvent:!1})})}getEnrollmentPaymentData(){this._studentsService.getEnrollmentPayments(this.estudianteID).subscribe(e=>{this.paymentEnrollmentData=e.data,this.enrollmentFG.patchValue(this.paymentEnrollmentData),console.log(this.paymentEnrollmentData)})}ngOnInit(){}regiterPaymentEnrollment(){this._studentsService.registerEnrollmentPayment(this.estudianteID,this.enrollmentFG.value).subscribe(e=>{this._globalService.openSnackBar("Pago de inscripci\xf3n guardado exitosamente",2e3,"success")})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.qu),t.Y36(C),t.Y36(x.U),t.Y36(_.gz),t.Y36(D.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payment-control-enrollment"]],decls:0,vars:0,template:function(e,o){},encapsulation:2}),n})();var S=s(1948),F=s(3848),U=s(9602);function Ut(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"creado"),t.qZA())}function qt(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"actualizado"),t.qZA())}function Nt(n,a){if(1&n&&(t.TgZ(0,"fuse-alert",62)(1,"span",63),t._uU(2,"Exito"),t.qZA(),t._uU(3," El alumno ha sido "),t.YNc(4,Ut,2,0,"span",27),t.YNc(5,qt,2,0,"span",27),t._uU(6," exitosamente "),t.qZA()),2&n){const e=t.oxw();t.Q6J("type","success"),t.xp6(4),t.Q6J("ngIf","1"===e.m),t.xp6(1),t.Q6J("ngIf","2"===e.m)}}function Pt(n,a){if(1&n&&(t.TgZ(0,"mat-option",64),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function wt(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El a\xf1o es requerido "),t.qZA())}function Jt(n,a){if(1&n&&(t.TgZ(0,"mat-option",64),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",a.index),t.xp6(1),t.Oqu(e)}}function Gt(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El mes es requerido "),t.qZA())}function Yt(n,a){if(1&n&&(t.TgZ(0,"mat-hint"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij("Monto restante: ",e.amountValidation*e.dolarBCV-(e.paymentFG.get("ves_amount").value||0)," VES")}}function Dt(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El monto es requerido "),t.qZA())}function It(n,a){if(1&n&&(t.TgZ(0,"mat-hint"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij("Monto restante: ",e.amountValidation-(e.paymentFG.get("usd_amount").value||0)," USD")}}function Qt(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El monto es requerido "),t.qZA())}function Et(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," La fecha es requerida "),t.qZA())}function Mt(n,a){1&n&&(t.TgZ(0,"mat-label"),t._uU(1,"Nombres y Apellidos"),t.qZA())}function Vt(n,a){1&n&&(t.TgZ(0,"mat-label"),t._uU(1,"Razon social"),t.qZA())}function kt(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre es requerido "),t.qZA())}function Bt(n,a){1&n&&(t.TgZ(0,"mat-option",82),t._uU(1,"V"),t.qZA())}function Lt(n,a){1&n&&(t.TgZ(0,"mat-option",83),t._uU(1,"E"),t.qZA())}function Ot(n,a){1&n&&(t.TgZ(0,"mat-option",84),t._uU(1,"J"),t.qZA())}function $t(n,a){1&n&&(t.TgZ(0,"mat-option",85),t._uU(1,"P"),t.qZA())}function jt(n,a){1&n&&(t.TgZ(0,"mat-option",86),t._uU(1,"G"),t.qZA())}function Rt(n,a){1&n&&(t.TgZ(0,"mat-label"),t._uU(1,"Cedula de Identidad"),t.qZA())}function zt(n,a){1&n&&(t.TgZ(0,"mat-label"),t._uU(1,"RIF"),t.qZA())}function Ht(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El documento es requerido "),t.qZA())}function Xt(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El metodo de pago es requerido "),t.qZA())}function Kt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",21)(1,"div",22)(2,"mat-form-field",0),t.YNc(3,Mt,2,0,"mat-label",27),t.YNc(4,Vt,2,0,"mat-label",27),t._UZ(5,"input",65),t.YNc(6,kt,2,0,"mat-error",27),t.qZA()(),t.TgZ(7,"div",22)(8,"div",23)(9,"div",22)(10,"mat-form-field",0),t._UZ(11,"mat-label"),t.TgZ(12,"mat-select",40),t.YNc(13,Bt,2,0,"mat-option",66),t.YNc(14,Lt,2,0,"mat-option",67),t.YNc(15,Ot,2,0,"mat-option",68),t.YNc(16,$t,2,0,"mat-option",69),t.YNc(17,jt,2,0,"mat-option",70),t.qZA()()(),t.TgZ(18,"div",37)(19,"mat-form-field",0),t.YNc(20,Rt,2,0,"mat-label",27),t.YNc(21,zt,2,0,"mat-label",27),t._UZ(22,"input",71),t.YNc(23,Ht,2,0,"mat-error",27),t.qZA()()()(),t.TgZ(24,"div",22)(25,"mat-form-field",0)(26,"mat-label"),t._uU(27,"Metodo de pago"),t.qZA(),t.TgZ(28,"mat-select",72)(29,"mat-option",73),t._uU(30,"Transferencia Bancaria"),t.qZA(),t.TgZ(31,"mat-option",74),t._uU(32,"Pago movil"),t.qZA(),t.TgZ(33,"mat-option",75),t._uU(34,"Efectivo"),t.qZA(),t.TgZ(35,"mat-option",76),t._uU(36,"Cheque"),t.qZA(),t.TgZ(37,"mat-option",77),t._uU(38,"Biopago"),t.qZA(),t.TgZ(39,"mat-option",78),t._uU(40,"Punto de venta"),t.qZA()(),t.YNc(41,Xt,2,0,"mat-error",27),t.qZA()(),t.TgZ(42,"div",22)(43,"mat-form-field",0)(44,"mat-label"),t._uU(45,"Numero de referencia"),t.qZA(),t._UZ(46,"input",79),t.qZA()(),t.TgZ(47,"div",80)(48,"div")(49,"button",81),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.regiterPayment())}),t._uU(50,"Registrar mensualidad"),t.qZA()()()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.paymentFG),t.xp6(3),t.Q6J("ngIf","Natural"===e.paymentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.paymentFG.get("payer_type").value),t.xp6(2),t.Q6J("ngIf",e.paymentFG.get("full_name").hasError("required")),t.xp6(6),t.Q6J("formControl",e.documentTypeFC),t.xp6(1),t.Q6J("ngIf","Natural"===e.paymentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Natural"===e.paymentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.paymentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.paymentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.paymentFG.get("payer_type").value),t.xp6(3),t.Q6J("ngIf","Natural"===e.paymentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.paymentFG.get("payer_type").value),t.xp6(2),t.Q6J("ngIf",e.paymentFG.get("document").hasError("required")),t.xp6(18),t.Q6J("ngIf",e.paymentFG.get("payment_method").hasError("required"))}}function Wt(n,a){if(1&n&&(t.TgZ(0,"mat-option",64),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function te(n,a){1&n&&(t.TgZ(0,"th",87),t._uU(1,"Mes"),t.qZA())}function ee(n,a){if(1&n&&(t.TgZ(0,"td",88)(1,"span",89),t._uU(2),t.qZA()()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(2),t.hij(" ",o.months[e.month]," ")}}function ne(n,a){1&n&&(t.TgZ(0,"th",87),t._uU(1,"Estado"),t.qZA())}function oe(n,a){1&n&&(t.TgZ(0,"span",93),t._uU(1,"Pendiente"),t.qZA())}function ae(n,a){1&n&&(t.TgZ(0,"span",94),t._uU(1,"Parcial"),t.qZA())}function ie(n,a){1&n&&(t.TgZ(0,"span",95),t._uU(1,"Pagado"),t.qZA())}function re(n,a){if(1&n&&(t.TgZ(0,"td",88)(1,"span",89),t.YNc(2,oe,2,0,"span",90),t.YNc(3,ae,2,0,"span",91),t.YNc(4,ie,2,0,"span",92),t.qZA()()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(2),t.Q6J("ngIf",0==o.getPaymentSum(e)),t.xp6(1),t.Q6J("ngIf",o.getPaymentSum(e)<o.currentMonthPrice&&o.getPaymentSum(e)>0),t.xp6(1),t.Q6J("ngIf",o.getPaymentSum(e)==o.currentMonthPrice)}}function le(n,a){1&n&&(t.TgZ(0,"th",87),t._uU(1,"Monto Abonado (USD)"),t.qZA())}function me(n,a){if(1&n&&(t.TgZ(0,"td",88)(1,"span",89),t._uU(2),t.qZA()()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(2),t.hij(" ",o.getPaymentSum(e)||0," USD ")}}function se(n,a){1&n&&(t.TgZ(0,"th",87),t._uU(1,"Pagos realizados"),t.qZA())}function ue(n,a){if(1&n&&(t.TgZ(0,"td",88)(1,"span",89),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.payments.length||0," ")}}function pe(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td")(12,"mat-icon",100),t._uU(13,"delete"),t.qZA()()()),2&n){const e=a.$implicit;t.xp6(2),t.Oqu(e.full_name?e.full_name:"-"),t.xp6(2),t.Oqu(e.payment_date?e.payment_date:"-"),t.xp6(2),t.Oqu(e.ves_amount?e.ves_amount:"-"),t.xp6(2),t.Oqu(e.usd_amount?e.usd_amount:"-"),t.xp6(2),t.Oqu(e.reference_number?e.reference_number:"-")}}function ce(n,a){if(1&n&&(t.TgZ(0,"td",88)(1,"div",96)(2,"div",97)(3,"table",98)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"Pagador"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Fecha de pago"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Monto de pago (VES)"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Monto de pago (USD)"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Referencia"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Acci\xf3n"),t.qZA()()(),t.TgZ(18,"tbody"),t.YNc(19,pe,14,5,"tr",99),t.qZA()()()()()),2&n){const e=a.$implicit,o=t.oxw();t.uIk("colspan",o.columns.length),t.xp6(1),t.Q6J("@detailExpand",e==o.expandedElement?"expanded":"collapsed"),t.xp6(18),t.Q6J("ngForOf",e.payments)}}function de(n,a){1&n&&t._UZ(0,"tr",101)}function _e(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr",102),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.expandedElement=m.expandedElement===r?null:r)}),t.qZA()}if(2&n){const e=a.$implicit,o=t.oxw();t.ekj("example-expanded-row",o.expandedElement===e)}}function ge(n,a){1&n&&t._UZ(0,"tr",103)}function fe(n,a){1&n&&(t.TgZ(0,"mat-label"),t._uU(1,"Nombres y Apellidos"),t.qZA())}function he(n,a){1&n&&(t.TgZ(0,"mat-label"),t._uU(1,"Razon social"),t.qZA())}function ve(n,a){1&n&&(t.TgZ(0,"mat-option",82),t._uU(1,"V"),t.qZA())}function ye(n,a){1&n&&(t.TgZ(0,"mat-option",83),t._uU(1,"E"),t.qZA())}function Ze(n,a){1&n&&(t.TgZ(0,"mat-option",84),t._uU(1,"J"),t.qZA())}function Ce(n,a){1&n&&(t.TgZ(0,"mat-option",85),t._uU(1,"P"),t.qZA())}function xe(n,a){1&n&&(t.TgZ(0,"mat-option",86),t._uU(1,"G"),t.qZA())}function Te(n,a){1&n&&(t.TgZ(0,"mat-label"),t._uU(1,"Cedula de Identidad"),t.qZA())}function be(n,a){1&n&&(t.TgZ(0,"mat-label"),t._uU(1,"RIF"),t.qZA())}function Ae(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",21)(1,"div",22)(2,"mat-form-field",0),t.YNc(3,fe,2,0,"mat-label",27),t.YNc(4,he,2,0,"mat-label",27),t._UZ(5,"input",65),t.qZA()(),t.TgZ(6,"div",22)(7,"div",23)(8,"div",22)(9,"mat-form-field",0),t._UZ(10,"mat-label"),t.TgZ(11,"mat-select",40),t.YNc(12,ve,2,0,"mat-option",66),t.YNc(13,ye,2,0,"mat-option",67),t.YNc(14,Ze,2,0,"mat-option",68),t.YNc(15,Ce,2,0,"mat-option",69),t.YNc(16,xe,2,0,"mat-option",70),t.qZA()()(),t.TgZ(17,"div",37)(18,"mat-form-field",0),t.YNc(19,Te,2,0,"mat-label",27),t.YNc(20,be,2,0,"mat-label",27),t._UZ(21,"input",71),t.qZA()()()(),t.TgZ(22,"div",22)(23,"mat-form-field",0)(24,"mat-label"),t._uU(25,"Metodo de pago"),t.qZA(),t.TgZ(26,"mat-select",72)(27,"mat-option",73),t._uU(28,"Transferencia Bancaria"),t.qZA(),t.TgZ(29,"mat-option",74),t._uU(30,"Pago movil"),t.qZA(),t.TgZ(31,"mat-option",75),t._uU(32,"Efectivo"),t.qZA(),t.TgZ(33,"mat-option",76),t._uU(34,"Cheque"),t.qZA(),t.TgZ(35,"mat-option",77),t._uU(36,"Biopago"),t.qZA(),t.TgZ(37,"mat-option",78),t._uU(38,"Punto de venta"),t.qZA()()()(),t.TgZ(39,"div",22)(40,"mat-form-field",0)(41,"mat-label"),t._uU(42,"Numero de referencia"),t.qZA(),t._UZ(43,"input",79),t.qZA()(),t.TgZ(44,"div",80)(45,"div")(46,"button",81),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.regiterPaymentEnrollment())}),t._uU(47,"Guardar informaci\xf3n de inscripci\xf3n"),t.qZA()()()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.enrollmentFG),t.xp6(3),t.Q6J("ngIf","Natural"===e.enrollmentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.enrollmentFG.get("payer_type").value),t.xp6(7),t.Q6J("formControl",e.documentTypeEnrollmentFG),t.xp6(1),t.Q6J("ngIf","Natural"===e.enrollmentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Natural"===e.enrollmentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.enrollmentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.enrollmentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.enrollmentFG.get("payer_type").value),t.xp6(3),t.Q6J("ngIf","Natural"===e.enrollmentFG.get("payer_type").value),t.xp6(1),t.Q6J("ngIf","Juridico"===e.enrollmentFG.get("payer_type").value)}}const Se=function(){return["expandedDetail"]},Fe=[{path:"lista",component:lt},{path:"crear",component:Y},{path:"editar/:id",component:Y},{path:"control-de-pago/:id",component:(()=>{class n extends Ft{constructor(e,o,i,r,m,p,Je){super(r,e,m,o,p),this._studentsService=e,this._activatedRoute=o,this._router=i,this._formBuilder=r,this._globalService=m,this._paymentControlService=p,this._fuseConfirmationService=Je,this.columns=["mes","estado","pagador","fecha_pago"],this.m=null,this._unsubscribeAll=new P.x,this.yearFC=new l.NI,this.currentDate=new Date,this.documentTypeFC=new l.NI,this.months=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],this.abonatedVESFC=new l.NI,this.abonatedUSDFC=new l.NI}ngOnInit(){this.paymentData=[];for(let e=0;e<12;e++)this.paymentData.push({month:e,debt:0,payments:[]});this._paymentControlService.getDolarBCV().subscribe(e=>{this.dolarBCV=e.data}),this._paymentControlService.getMonthPrice().subscribe(e=>{this.currentMonthPrice=e.data,this.amountValidation=e.data,this.paymentData=this.paymentData.map(o=>({...o,debt:this.amountValidation}))}),this._paymentControlService.getYears().subscribe(e=>{const o=e.data.map(i=>i.year);this.years=o.filter((i,r)=>o.indexOf(i)===r),this.yearFC.setValue((new Date).getFullYear(),{emitEvent:!1})}),this.paymentFG=this._formBuilder.group({full_name:[,l.kI.required],document:[,l.kI.required],month:[,l.kI.required],year:[,l.kI.required],ves_amount:[,l.kI.required],usd_amount:[,l.kI.required],payment_date:[,l.kI.required],payment_method:[,l.kI.required],reference_number:[],payer_type:[,l.kI.required]}),this.paymentFG.get("ves_amount").valueChanges.subscribe(e=>{let o=parseFloat((e/this.dolarBCV).toFixed(2));o>this.amountValidation&&(o=this.amountValidation,this.paymentFG.get("ves_amount").setValue(this.amountValidation*this.dolarBCV,{emitEvent:!1})),this.paymentFG.get("usd_amount").setValue(o,{emitEvent:!1})}),this.paymentFG.get("usd_amount").valueChanges.subscribe(e=>{let o=parseFloat((e*this.dolarBCV).toFixed(2));o>this.amountValidation*this.dolarBCV&&(o=this.amountValidation*this.dolarBCV,this.paymentFG.get("usd_amount").setValue(this.amountValidation,{emitEvent:!1})),this.paymentFG.get("ves_amount").setValue(o,{emitEvent:!1})}),this.paymentFG.get("year").valueChanges.subscribe(e=>{this.amountValidation=this.currentMonthPrice,e===this.yearFC.value&&(this.paymentFG.get("month").value||0==this.paymentFG.get("month").value)&&(this.amountValidation=this.paymentData.find(o=>o.month===this.paymentFG.get("month").value).debt)}),this.paymentFG.get("month").valueChanges.subscribe(e=>{this.amountValidation=this.currentMonthPrice,this.paymentFG.get("year").value===this.yearFC.value&&(e||0==e)&&(this.amountValidation=this.paymentData.find(o=>o.month===e).debt)}),this.paymentFG.get("payer_type").valueChanges.subscribe(e=>{this.documentTypeFC.setValue("Natural"===e?"V":"J")}),this.paymentFG.get("payer_type").setValue("Natural"),this.seachFormGroup=this._formBuilder.group({file:[null],city:[null],company:[null],profession:[null],fileSelect:["Seleccionar"],citySelect:["Seleccionar"],companySelect:["Seleccionar"],professionSelect:["Seleccionar"]}),this._activatedRoute.params.pipe((0,w.R)(this._unsubscribeAll)).subscribe(e=>{e.m&&(this.m=e.m),e.id&&(this.studentID=e.id,this.getPaymentData((new Date).getFullYear()),this.getStudentData())}),this.yearFC.valueChanges.subscribe(e=>{this.getPaymentData(e)})}getStudentData(){this._studentsService.get(this.studentID).subscribe(e=>{this.studentData=e.data,console.log(e)})}getPaymentData(e){this._studentsService.getPayments(this.studentID,e).subscribe(o=>{this.paymentData=this.paymentData.map((i,r)=>({...i,debt:o.data.filter(m=>m.month===r+1).reduce((m,p)=>m-p.usd_amount,i.debt)||0,payments:o.data.filter(m=>m.month===r+1)||[]}))})}filter(e,o){const i=e.toLowerCase();return o.filter(r=>(r||"").toLowerCase().includes(i))}regiterPayment(){if(this.paymentFG.invalid)return this._globalService.openSnackBar("Debes ingresar la informaci\xf3n de los campos obligatorios",2e3,"error"),void this.paymentFG.markAllAsTouched();this._studentsService.registerPayment(this.studentID,this.paymentFG.value).subscribe(e=>{this._globalService.openSnackBar("Pago registrado",2e3,"success"),this.yearFC.value==(new Date).getFullYear()&&(this.paymentData=this.paymentData.map((o,i)=>o.month===this.paymentFG.get("month").value?{...o,debt:o.debt-this.paymentFG.get("usd_amount").value,payments:[...o.payments,e.data]}:o),this.paymentFG.reset(),this.paymentFG.get("payer_type").setValue("Natural"))})}goToStudent(e){this._router.navigate(["alumnos","editar",e])}goToPaymentControl(e){this._router.navigate(["alumnos","control-de-pago",e])}openDialog(e){this._fuseConfirmationService.open({title:"Atenci\xf3n",message:"\xbfEst\xe1 seguro que desea eliminar este pago?. Esta acci\xf3n no se puede deshacer.",icon:{show:!0,name:"heroicons_outline:exclamation",color:"warning"},actions:{confirm:{show:!0,label:"Confirmar",color:"accent"},cancel:{show:!0,label:"Cancelar"}},dismissible:!0}).afterClosed().subscribe(i=>{"confirmed"===i&&this._paymentControlService.delete(e).subscribe(r=>{this._globalService.openSnackBar("Alumno eliminado",5e3,"success"),this.getPaymentData(this.yearFC.value)})})}getPaymentSum(e){return e.payments.reduce((o,i)=>o+i.usd_amount,0)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(C),t.Y36(_.gz),t.Y36(_.F0),t.Y36(l.qu),t.Y36(x.U),t.Y36(D.s),t.Y36(J.R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payment-control"]],features:[t.qOj],decls:174,vars:43,consts:[[1,"w-full"],[1,"grid","sm:grid-cols-2","gap-8","w-full","mb-6"],[1,"w-full","col-span-1"],[1,"text-3xl","font-bold"],[1,"text-secondary"],[1,"text-right"],[1,"w-18","text-center",2,"margin-left","auto"],["src","/assets/bcv.png","alt","",1,"w-full"],[1,"mt-1"],[3,"type",4,"ngIf"],["mat-stretch-tabs","false","mat-align-tabs","start"],["label","Pago mensualidades"],[1,"sm:col-span-6","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden","mb-5"],[1,"grid","grid-cols-12","mb-7"],[1,"col-span-6"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[1,"w-fit","ml-auto",3,"formGroup"],[1,"mb-2"],["formControlName","payer_type","aria-label","Select an option"],["value","Natural",2,"margin-right","20px"],["value","Juridico"],[1,"grid","grid-cols-12","gap-5",3,"formGroup"],[1,"col-span-3"],[1,"grid","grid-cols-12","gap-2"],[1,"col-span-5"],["formControlName","year"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-span-7"],["formControlName","month"],["formControlName","ves_amount","id","name","type","text","matInput","","disabled",""],["formControlName","usd_amount","id","name","type","text","matInput","","disabled",""],["formControlName","payment_date","matInput","",3,"value","matDatepicker","click"],["picker",""],["class","grid grid-cols-12 gap-5",3,"formGroup",4,"ngIf"],[1,"sm:col-span-6","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"grid","grid-cols-12"],[1,"col-span-9"],[1,"flex","gap-3","justify-end",3,"formGroup"],[1,"w-2/5"],[3,"formControl"],[1,"flex","flex-col","flex-auto","mt-2","overflow-x-auto"],["mat-table","","multiTemplateDataRows","",1,"min-w-240","overflow-y-visible",3,"dataSource"],["matColumnDef","mes"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","estado"],["matColumnDef","pagador"],["matColumnDef","fecha_pago"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["class","cursor-pointer","mat-row","","class","example-element-row",3,"example-expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],["label","Pago inscripci\xf3n"],[1,"my-5"],[1,"max-w-100","mx-auto","text-center"],[1,""],[1,"my-4"],[1,"col-span-4"],["formControlName","ves_amount","id","name","type","text","matInput",""],["formControlName","usd_amount","id","name","type","text","matInput",""],["picker2",""],[3,"type"],["fuseAlertTitle",""],[3,"value"],["formControlName","full_name","id","name","type","text","matInput",""],["value","V",4,"ngIf"],["value","E",4,"ngIf"],["value","J",4,"ngIf"],["value","P",4,"ngIf"],["value","G",4,"ngIf"],["formControlName","document","id","name","type","text","matInput",""],["formControlName","payment_method"],["value","Transferencia bancaria"],["value","Pago movil"],["value","Efectivo"],["value","Cheque"],["value","Biopago"],["value","Punto de venta"],["formControlName","reference_number","id","name","type","text","matInput",""],[1,"col-span-12"],["mat-stroked-button","",1,"rounded","w-full","p-0","bg-primary-300","text-on-primary-300",3,"click"],["value","V"],["value","E"],["value","J"],["value","P"],["value","G"],["mat-header-cell",""],["mat-cell",""],[1,"font-medium"],["class","text-red-600",4,"ngIf"],["class","text-yellow-600",4,"ngIf"],["class","text-green-600",4,"ngIf"],[1,"text-red-600"],[1,"text-yellow-600"],[1,"text-green-600"],[1,"example-element-detail","w-full"],[1,"w-full",2,"padding","13px 10px 30px"],[1,"simple-table"],[4,"ngFor","ngForOf"],[1,"text-red-800","cursor-pointer"],["mat-header-row",""],["mat-row","",1,"example-element-row",3,"click"],["mat-row","",1,"example-detail-row"]],template:function(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Control de pagos"),t.qZA(),t.TgZ(5,"div",4),t._uU(6,"Gestiona la informacion de pago para el alumno: "),t.TgZ(7,"strong"),t._uU(8),t.qZA()()(),t.TgZ(9,"div",2)(10,"div",5)(11,"div",6),t._UZ(12,"img",7),t.TgZ(13,"div",8),t._uU(14),t.qZA()()()(),t.TgZ(15,"div",2),t.YNc(16,Nt,7,3,"fuse-alert",9),t.qZA()(),t.TgZ(17,"mat-tab-group",10)(18,"mat-tab",11)(19,"div",12)(20,"div",13)(21,"div",14)(22,"div",15),t._uU(23,"Registrar pago de mensualidad"),t.qZA(),t.TgZ(24,"div"),t._uU(25,"Valor de mensualidad (USD): "),t.TgZ(26,"strong"),t._uU(27),t.qZA()(),t.TgZ(28,"div"),t._uU(29,"Valor de mensualidad (VES): "),t.TgZ(30,"strong"),t._uU(31),t.ALo(32,"number"),t.qZA()()(),t.TgZ(33,"div",14)(34,"div",16)(35,"div",17)(36,"strong"),t._uU(37,"Entidad que realiza el pago"),t.qZA()(),t.TgZ(38,"mat-radio-group",18)(39,"mat-radio-button",19),t._uU(40,"Persona Natural"),t.qZA(),t.TgZ(41,"mat-radio-button",20),t._uU(42,"Entidad Juridica"),t.qZA()()()()(),t.TgZ(43,"div",21)(44,"div",22)(45,"div",23)(46,"div",24)(47,"mat-form-field",0)(48,"mat-label"),t._uU(49,"A\xf1o"),t.qZA(),t.TgZ(50,"mat-select",25),t.YNc(51,Pt,2,2,"mat-option",26),t.qZA(),t.YNc(52,wt,2,0,"mat-error",27),t.qZA()(),t.TgZ(53,"div",28)(54,"mat-form-field",0)(55,"mat-label"),t._uU(56,"Mes"),t.qZA(),t.TgZ(57,"mat-select",29),t.YNc(58,Jt,2,2,"mat-option",26),t.qZA(),t.YNc(59,Gt,2,0,"mat-error",27),t.qZA()()()(),t.TgZ(60,"div",22)(61,"mat-form-field",0)(62,"mat-label"),t._uU(63,"Monto Abonado (VES)"),t.qZA(),t._UZ(64,"input",30),t.YNc(65,Yt,2,1,"mat-hint",27),t.YNc(66,Dt,2,0,"mat-error",27),t.qZA()(),t.TgZ(67,"div",22)(68,"mat-form-field",0)(69,"mat-label"),t._uU(70,"Monto Abonado (USD)"),t.qZA(),t._UZ(71,"input",31),t.YNc(72,It,2,1,"mat-hint",27),t.YNc(73,Qt,2,0,"mat-error",27),t.qZA()(),t.TgZ(74,"div",22)(75,"mat-form-field",0)(76,"mat-label"),t._uU(77,"Fecha de abono"),t.qZA(),t.TgZ(78,"input",32),t.NdJ("click",function(){t.CHM(i);const m=t.MAs(82);return t.KtG(m.open())}),t.qZA(),t.TgZ(79,"mat-hint"),t._uU(80,"MM/DD/YYYY"),t.qZA(),t._UZ(81,"mat-datepicker",null,33),t.YNc(83,Et,2,0,"mat-error",27),t.qZA()()(),t.YNc(84,Kt,51,14,"div",34),t.qZA(),t.TgZ(85,"div",35)(86,"div",36)(87,"div",22)(88,"div",15),t._uU(89,"Detalles de alumno"),t.qZA()(),t.TgZ(90,"div",37)(91,"div",38)(92,"div",39)(93,"mat-form-field",0)(94,"mat-label"),t._uU(95,"A\xf1o de gestion"),t.qZA(),t.TgZ(96,"mat-select",40),t.YNc(97,Wt,2,2,"mat-option",26),t.qZA()()()()()(),t.TgZ(98,"div",41)(99,"table",42),t.ynx(100,43),t.YNc(101,te,2,0,"th",44),t.YNc(102,ee,3,1,"td",45),t.BQk(),t.ynx(103,46),t.YNc(104,ne,2,0,"th",44),t.YNc(105,re,5,3,"td",45),t.BQk(),t.ynx(106,47),t.YNc(107,le,2,0,"th",44),t.YNc(108,me,3,1,"td",45),t.BQk(),t.ynx(109,48),t.YNc(110,se,2,0,"th",44),t.YNc(111,ue,3,1,"td",45),t.BQk(),t.ynx(112,49),t.YNc(113,ce,20,3,"td",45),t.BQk(),t.YNc(114,de,1,0,"tr",50),t.YNc(115,_e,1,2,"tr",51),t.YNc(116,ge,1,0,"tr",52),t.qZA()()()(),t.TgZ(117,"mat-tab",53)(118,"div",54)(119,"div",55)(120,"div"),t._uU(121,"Registro de pago de inscripcion del a\xf1o escolar "),t.TgZ(122,"strong"),t._uU(123,"2023-2024"),t.qZA(),t._uU(124," para el alumno "),t.TgZ(125,"strong"),t._uU(126),t.qZA()()(),t.TgZ(127,"div",56)(128,"div",57)(129,"div",12)(130,"div",13)(131,"div",14)(132,"div",15),t._uU(133,"Registrar pago de inscripci\xf3n"),t.qZA(),t.TgZ(134,"div"),t._uU(135,"Valor de inscripci\xf3n (USD): "),t.TgZ(136,"strong"),t._uU(137),t.qZA()(),t.TgZ(138,"div"),t._uU(139,"Valor de inscripci\xf3n (VES): "),t.TgZ(140,"strong"),t._uU(141),t.ALo(142,"number"),t.qZA()()(),t.TgZ(143,"div",14)(144,"div",16)(145,"div",17)(146,"strong"),t._uU(147,"Entidad que realiza el pago"),t.qZA()(),t.TgZ(148,"mat-radio-group",18)(149,"mat-radio-button",19),t._uU(150,"Persona Natural"),t.qZA(),t.TgZ(151,"mat-radio-button",20),t._uU(152,"Entidad Juridica"),t.qZA()()()()(),t.TgZ(153,"div",21)(154,"div",58)(155,"mat-form-field",0)(156,"mat-label"),t._uU(157,"Monto Abonado (VES)"),t.qZA(),t._UZ(158,"input",59),t.qZA()(),t.TgZ(159,"div",58)(160,"mat-form-field",0)(161,"mat-label"),t._uU(162,"Monto Abonado (USD)"),t.qZA(),t._UZ(163,"input",60),t.qZA()(),t.TgZ(164,"div",58)(165,"mat-form-field",0)(166,"mat-label"),t._uU(167,"Fecha de abono"),t.qZA(),t.TgZ(168,"input",32),t.NdJ("click",function(){t.CHM(i);const m=t.MAs(172);return t.KtG(m.open())}),t.qZA(),t.TgZ(169,"mat-hint"),t._uU(170,"MM/DD/YYYY"),t.qZA(),t._UZ(171,"mat-datepicker",null,61),t.qZA()()(),t.YNc(173,Ae,48,11,"div",34),t.qZA()()()()()()()}if(2&e){const i=t.MAs(82),r=t.MAs(172);t.xp6(8),t.AsE("",o.studentData.name," ",o.studentData.last_name,""),t.xp6(6),t.hij("",o.dolarBCV," Bs"),t.xp6(2),t.Q6J("ngIf",o.m),t.xp6(11),t.hij("",o.currentMonthPrice," USD"),t.xp6(4),t.hij("",t.xi3(32,36,o.currentMonthPrice*o.dolarBCV,"1.2-2")," VES"),t.xp6(3),t.Q6J("formGroup",o.paymentFG),t.xp6(9),t.Q6J("formGroup",o.paymentFG),t.xp6(8),t.Q6J("ngForOf",o.years),t.xp6(1),t.Q6J("ngIf",o.paymentFG.get("year").hasError("required")),t.xp6(6),t.Q6J("ngForOf",o.months),t.xp6(1),t.Q6J("ngIf",o.paymentFG.get("month").hasError("required")),t.xp6(6),t.Q6J("ngIf",(o.paymentFG.get("month").value||0==o.paymentFG.get("month").value)&&o.paymentFG.get("year").value),t.xp6(1),t.Q6J("ngIf",o.paymentFG.get("ves_amount").hasError("required")),t.xp6(6),t.Q6J("ngIf",(o.paymentFG.get("month").value||0==o.paymentFG.get("month").value)&&o.paymentFG.get("year").value),t.xp6(1),t.Q6J("ngIf",o.paymentFG.get("usd_amount").hasError("required")),t.xp6(5),t.Q6J("value",o.currentDate)("matDatepicker",i),t.xp6(5),t.Q6J("ngIf",o.paymentFG.get("payment_date").hasError("required")),t.xp6(1),t.Q6J("ngIf",o.paymentFG.get("payer_type").value),t.xp6(7),t.Q6J("formGroup",o.seachFormGroup),t.xp6(5),t.Q6J("formControl",o.yearFC),t.xp6(1),t.Q6J("ngForOf",o.years),t.xp6(2),t.Q6J("dataSource",o.paymentData),t.xp6(15),t.Q6J("matHeaderRowDef",o.columns),t.xp6(1),t.Q6J("matRowDefColumns",o.columns),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(42,Se)),t.xp6(10),t.AsE("",o.studentData.name," ",o.studentData.last_name,""),t.xp6(11),t.hij("",o.enrollmentFee," USD"),t.xp6(4),t.hij("",t.xi3(142,39,o.enrollmentFee*o.dolarBCV,"1.2-2")," VES"),t.xp6(3),t.Q6J("formGroup",o.enrollmentFG),t.xp6(9),t.Q6J("formGroup",o.enrollmentFG),t.xp6(15),t.Q6J("value",o.currentDate)("matDatepicker",r),t.xp6(5),t.Q6J("ngIf",o.enrollmentFG.get("payer_type").value)}},dependencies:[g.sg,g.O5,y.lW,d.TO,d.KE,d.bx,d.hX,Z.gD,A.ey,l.Fj,l.JJ,l.JL,l.oH,l.sg,l.u,f.Nt,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,S.VQ,S.U0,G.W,F.SP,F.uX,T.Hw,U.Mq,U.hl,g.JJ],styles:["tr.example-detail-row[_ngcontent-%COMP%]{height:0}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):hover{background:whitesmoke}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):active{background:#efefef}.example-element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.example-element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.example-element-diagram[_ngcontent-%COMP%]{min-width:80px;border:2px solid black;padding:8px;font-weight:lighter;margin:8px 0;height:104px}.example-element-symbol[_ngcontent-%COMP%]{font-weight:700;font-size:40px;line-height:normal}.example-element-description[_ngcontent-%COMP%]{padding:16px}.example-element-description-attribution[_ngcontent-%COMP%]{opacity:.5}.simple-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-spacing:0;border:1px solid #ddd}.simple-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f5f5f5}.simple-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .simple-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;border:1px solid #ddd}"],data:{animation:[(0,h.X$)("detailExpand",[(0,h.SB)("collapsed",(0,h.oB)({height:"0px",minHeight:"0"})),(0,h.SB)("expanded",(0,h.oB)({height:"*"})),(0,h.eR)("expanded <=> collapsed",(0,h.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),n})()},{path:"",pathMatch:"full",redirectTo:"lista"}];var q=s(979),I=s(6709);let Ue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,d.lN,f.c,Z.LD,l.UX,l.u5,I.p9,y.ot,q.c]}),n})();var Q=s(7775),E=s(3231),M=s(266);let qe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,y.ot,d.lN,Z.LD,l.UX,_.Bz,l.u5,f.c,M.AV,f.c,u.p0,E.Co,Q.fC,b.TU,q.c,T.Ps]}),n})();var Ne=s(7937);let Pe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,y.ot,d.lN,Z.LD,l.UX,_.Bz,l.u5,f.c,M.AV,f.c,u.p0,S.Fk,E.Co,Q.fC,b.TU,F.Nh,q.c,T.Ps,U.FA,I.p9,A.XK,Ne.w]}),n})(),we=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,_.Bz.forChild(Fe),Pe,Ue,qe]}),n})()}}]);